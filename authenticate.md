# Sparkweb Authentication Mechanism

SparkWeb uses JSON Web Tokens (JWTs) as access tokens for multiple REST API requests and SSE connections from the same user. All these connections share the same XMPP client session.  A user must aquire an access token to create and access this XMPP client session by authenticating.

Several authentication protocols are available for a developer to combine and create a multi factor authentication experience.

## Web Credentials
Web Credentials API allows standard username and password to be stored and recalled from the web browser and used with HTTP Basic Authentication over TLS (HTTPS) for both REST and SSE connections.

The username/password credential can be stored after a successful login and user thereafter with little or no user intervention.

## Web Authentication (WebAuthn)
Web Authentication API allows Openfire to register and authenticate users using public key cryptography instead of a password. It allows Openfire to integrate with the strong authenticators now built into devices, like Windows Hello or Apple’s Touch ID. Instead of a password, a private-public keypair (known as a credential) is created for SparkWeb. The private key is stored securely on the user’s device; a public key and randomly generated credential ID is sent to Openfire for storage. Openfire can then use that public key to prove the user’s identity.

A username/password credential is till needed to authenticate a user in order to register the password-less device and store the credential ID in Openfire. After that a user authenticates via the registered device. Web browser enable mobile phones to be used an authenticator device.

SparkWeb provides the REST APIs to start/finish a WebAthn authentication registration as well as start/finish a WebAuthn authentication.

The end result is a JWT that can be used over TLS (HTTPS) for both REST and SSE connections.

## Time based One Time Passwords
SparkWeb supports the use of an TOTP application to generate time based passwords that can authenticate a user. The mechanism is used mostly with mobile phone that have a TOTP application that will generate a code which will match with SparkWeb.

Like Web Authn, Openfire must be registered in the TOTP application. This is done with a QR Code generated by a REST API call.

Another REST API can be used to perform the authentication with the generated code. The end result is also a JWT that can be used over TLS (HTTPS) for both REST and SSE connections.
